

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Tutorial &mdash; sbmlxdf 0.2.3 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Command Line Scripts" href="scripts.html" />
    <link rel="prev" title="Installation" href="install.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> sbmlxdf
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#convert-sbml-model-to-spreadsheet">1. Convert SBML model to spreadsheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spreadsheet-to-sbml-model">2. Spreadsheet to SBML model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#checking-compliance-with-sbml-specifications">3. Checking compliance with SBML specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="#model-update">4. Model Update</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sbml-model-in-latest-sbml-version">5. SBML model in latest SBML version</a></li>
<li class="toctree-l2"><a class="reference internal" href="#python-access-to-sbml-model-data">6. Python access to SBML model data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-time-course-analysis">7. Run time course analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#time-course-analysis-in-copasi">7.1 Time course analysis in COPASI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#time-course-in-tellurium">7.2 Time course in tellurium</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#adding-application-specific-annotations">8. Adding application specific annotations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Command Line Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="spreadsheet.html">Spreadsheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="methods.html">sbmlxdf Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">sbmlxdf</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/tutorial.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<p>This tutorial provides a workflow for creating and modifying SBML models.
Basic Python knowledge is required. Modelers without programming experience
could use command line scrips to convert SBML to spreadsheet and spreadsheet
back to SBML, for this please check <a class="reference internal" href="scripts.html"><span class="doc">Command Line Scripts</span></a>.</p>
<div class="section" id="convert-sbml-model-to-spreadsheet">
<h2>1. Convert SBML model to spreadsheet<a class="headerlink" href="#convert-sbml-model-to-spreadsheet" title="Permalink to this headline">¶</a></h2>
<p>As an example, download from BioModels database the SBML model
<a class="reference external" href="https://www.ebi.ac.uk/biomodels/BIOMD0000000010#Files">BIOMD0000000010_url.xml</a>.
This is a kinetic SBML model based on a scientific publication from
Kholodenko <a class="reference internal" href="references.html#mapk" id="id1"><span>[MAPK]</span></a>.</p>
<p>Assuming the model is in the directory where you execute
you Python code. This SBML model can be converted to a spreadsheet
document as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sbmlxdf</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">sbmlxdf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;BIOMD0000000010_url.xml&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;BIOMD0000000010_ulr.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You may now open the spreadsheet document. It will contain 5 sheets.</p>
<ul class="simple">
<li><p><strong>sbml</strong></p></li>
<li><p><strong>modelAttrs</strong></p></li>
<li><p><strong>unitDefs</strong></p></li>
<li><p><strong>compartments</strong></p></li>
<li><p><strong>species</strong></p></li>
<li><p><strong>reactions</strong></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Number of sheets and their names in the spreadsheet document
depend on the type of components stored in the model.</p>
</div>
<p>E.g. sheet <strong>sbml</strong> contains level and version of the SBML document, in this
case Level 2 version 4.</p>
<div class="figure align-default" id="id3">
<img alt="_images/bio10_reaction_sheet.png" src="_images/bio10_reaction_sheet.png" />
<p class="caption"><span class="caption-text">reaction sheet (column names are highlighted)</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>The <strong>reaction</strong> sheet contains all information related to reactions this model:</p>
<ul class="simple">
<li><p><strong>id</strong>: identifier of the reaction</p></li>
<li><p><strong>name</strong>: a more human readable name</p></li>
<li><p><strong>metaid</strong>: required for miriam-annotations and model history</p></li>
<li><p><strong>miriam-annotation</strong>: records (“;” - separated) with qualifier elements and
resources (‘<a class="reference external" href="http://identifiers.org/">http://identifiers.org/</a>’ removed)</p></li>
<li><p><strong>reversible</strong>: boolean value for reaction reversibility</p></li>
<li><p><strong>reactants</strong>: reactants of the reaction (“;” - separated)</p></li>
<li><p><strong>products</strong></p></li>
<li><p><strong>modifiers</strong></p></li>
<li><p><strong>kineticLaw</strong></p></li>
<li><p><strong>local parameters</strong>: parameters used in a kinetic law can be either local
or global</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SBML kinetics are change of <strong>amount per time unit</strong> and not change of
concentration per time unit. In the kinetic laws you usually will
pre-multiply the ‘traditional’ kinetic law with the compartment volume.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Number of columns in a sheet depend on the type of attributes used
in the model. There are optional and mandatory attributes. Column order
does not matter, with the exception of the <code class="docutils literal notranslate"><span class="pre">id</span></code> column which must
be the first in most of the sheets (<code class="docutils literal notranslate"><span class="pre">id</span></code> it is used as an index).</p>
</div>
</div>
<div class="section" id="spreadsheet-to-sbml-model">
<h2>2. Spreadsheet to SBML model<a class="headerlink" href="#spreadsheet-to-sbml-model" title="Permalink to this headline">¶</a></h2>
<p>Continuing from above example, copy the spreadsheet and name it
<code class="docutils literal notranslate"><span class="pre">BIO10_upd.xlsx</span></code>. We are not changing anything in the model for now. We
just check how to convert a spreadsheet to SBML. We also verify that no
information gets lost during transfer and none of the attribute values change.</p>
<p>We convert the spreadsheet to SBML with following commands:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">upd_model</span> <span class="o">=</span> <span class="n">sbmlxdf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;BIO10_upd.xlsx&#39;</span><span class="p">)</span>
<span class="n">upd_model</span><span class="o">.</span><span class="n">export_sbml</span><span class="p">(</span><span class="s1">&#39;BIO10_upd.xml&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">BIO10_upd.xml</span></code> should now be identical to the original SBML model
<code class="docutils literal notranslate"><span class="pre">BIOMD0000000010_url.xml</span></code>, at least it should contain the same information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Original and newly created SBML files are not exactly identical.
sbmlxdf inserts a XML-comment with sbmlxdf creation time,
libsbml version used and the model creation time.
Sequence of XML elements and XML attributes might change.</p>
</div>
<p>To check if <code class="docutils literal notranslate"><span class="pre">BIO10_upd.xml</span></code> in fact contains all the information of the original
model, we can convert it back to spreadsheet and compare it with the
spreadsheet of the original model <code class="docutils literal notranslate"><span class="pre">BIOMD0000000010_url.xlsx</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">sbmlxdf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;BIO10_upd.xml&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">export_sbml</span><span class="p">(</span><span class="s1">&#39;BIO10_upd.xls&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Comparing <code class="docutils literal notranslate"><span class="pre">BIOMD0000000010_url.xlsx</span></code> with <code class="docutils literal notranslate"><span class="pre">BIO10_upd.xlsx</span></code> confirms,
that no information got lost in the transfer from spreadsheet to SBML and back
to spreadsheet.</p>
</div>
<div class="section" id="checking-compliance-with-sbml-specifications">
<h2>3. Checking compliance with SBML specifications<a class="headerlink" href="#checking-compliance-with-sbml-specifications" title="Permalink to this headline">¶</a></h2>
<p>Continuing from above. Though we successfully created a SBML model from
a spreadsheet document, we have not checked if this model actually complies fully
to SBML specifications. To improve model quality, it is recommended to first
validate the model and only after successful validation create the SBML file.</p>
<p><strong>libSBML</strong>, the API used in the background to access SBML data structures,
contains methods for checking compliance to SBML standards. These validation
routines are invoked with the method <code class="docutils literal notranslate"><span class="pre">validate_sbml()</span></code>. This method
creates an error report (<code class="docutils literal notranslate"><span class="pre">tmp.txt</span></code>) and a SBML file (<code class="docutils literal notranslate"><span class="pre">tmp.xml</span></code>), both in
directory <code class="docutils literal notranslate"><span class="pre">./results</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">upd_model</span> <span class="o">=</span> <span class="n">sbmlxdf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;BIO10_upd.xlsx&#39;</span><span class="p">)</span>
<span class="n">upd_model</span><span class="o">.</span><span class="n">validate_sbml</span><span class="p">(</span><span class="s1">&#39;tmp.xml&#39;</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;Warnings&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
</pre></div>
</div>
<p>10 warnings are reported. Now open <code class="docutils literal notranslate"><span class="pre">./results/tmp.txt</span></code> with a text editor.</p>
<p>first few lines of <code class="docutils literal notranslate"><span class="pre">./results/tmp.txt</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;Warnings&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span> <span class="n">OK</span><span class="p">:</span> <span class="n">SBML</span> <span class="n">compliant</span>
<span class="n">line</span> <span class="mi">233</span><span class="p">:</span> <span class="p">(</span><span class="mi">99505</span> <span class="p">[</span><span class="ne">Warning</span><span class="p">])</span> <span class="n">In</span> <span class="n">situations</span> <span class="n">where</span> <span class="n">a</span> <span class="n">mathematical</span> <span class="n">expression</span>
<span class="n">contains</span> <span class="n">literal</span> <span class="n">numbers</span> <span class="ow">or</span> <span class="n">parameters</span> <span class="n">whose</span> <span class="n">units</span> <span class="n">have</span> <span class="ow">not</span> <span class="n">been</span> <span class="n">declared</span><span class="p">,</span>
<span class="ow">is</span> <span class="ow">not</span> <span class="n">possible</span> <span class="n">to</span> <span class="n">verify</span> <span class="n">accurately</span> <span class="n">the</span> <span class="n">consistency</span> <span class="n">of</span> <span class="n">the</span> <span class="n">units</span> <span class="ow">in</span> <span class="n">the</span>
<span class="n">expression</span><span class="o">.</span>
<span class="n">The</span> <span class="n">units</span> <span class="n">of</span> <span class="n">the</span> <span class="o">&lt;</span><span class="n">kineticLaw</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">math</span><span class="o">&gt;</span> <span class="n">expression</span> <span class="s1">&#39;uVol * V1 * MKKK / ((1 +</span>
<span class="nb">pow</span><span class="p">(</span><span class="n">MAPK_PP</span> <span class="o">/</span> <span class="n">Ki</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">K1</span> <span class="o">+</span> <span class="n">MKKK</span><span class="p">))</span><span class="s1">&#39; cannot be fully checked. Unit</span>
<span class="n">consistency</span> <span class="n">reported</span> <span class="k">as</span> <span class="n">either</span> <span class="n">no</span> <span class="n">errors</span> <span class="ow">or</span> <span class="n">further</span> <span class="n">unit</span> <span class="n">errors</span> <span class="n">related</span> <span class="n">to</span>
<span class="n">this</span> <span class="nb">object</span> <span class="n">may</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">accurate</span><span class="o">.</span>

<span class="n">line</span> <span class="mi">294</span><span class="p">:</span> <span class="p">(</span><span class="mi">99505</span> <span class="p">[</span><span class="ne">Warning</span><span class="p">])</span> <span class="n">In</span> <span class="n">situations</span> <span class="n">where</span> <span class="n">a</span> <span class="n">mathematical</span> <span class="n">expression</span>
<span class="n">contains</span> <span class="n">literal</span> <span class="n">numbers</span> <span class="ow">or</span> <span class="n">parameters</span> <span class="n">whose</span> <span class="n">units</span> <span class="n">have</span> <span class="ow">not</span> <span class="n">been</span> <span class="n">declared</span><span class="p">,</span>
<span class="n">it</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">possible</span> <span class="n">to</span> <span class="n">verify</span> <span class="n">accurately</span> <span class="n">the</span> <span class="n">consistency</span> <span class="n">of</span> <span class="n">the</span> <span class="n">units</span> <span class="ow">in</span> <span class="n">the</span>
<span class="n">expression</span><span class="o">.</span>
<span class="n">The</span> <span class="n">units</span> <span class="n">of</span> <span class="n">the</span> <span class="o">&lt;</span><span class="n">kineticLaw</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">math</span><span class="o">&gt;</span> <span class="n">expression</span> <span class="s1">&#39;uVol * V2 * MKKK_P /</span>
<span class="p">(</span><span class="n">KK2</span> <span class="o">+</span> <span class="n">MKKK_P</span><span class="p">)</span><span class="s1">&#39; cannot be fully checked. Unit consistency reported as either</span>
<span class="n">no</span> <span class="n">errors</span> <span class="ow">or</span> <span class="n">further</span> <span class="n">unit</span> <span class="n">errors</span> <span class="n">related</span> <span class="n">to</span> <span class="n">this</span> <span class="nb">object</span> <span class="n">may</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">accurate</span><span class="o">.</span>

<span class="n">line</span> <span class="mi">345</span><span class="p">:</span> <span class="p">(</span><span class="mi">99505</span> <span class="p">[</span><span class="ne">Warning</span><span class="p">])</span> <span class="n">In</span> <span class="n">situations</span> <span class="n">where</span> <span class="n">a</span> <span class="n">mathematical</span> <span class="n">expression</span>
<span class="n">contains</span> <span class="n">literal</span> <span class="n">numbers</span> <span class="ow">or</span> <span class="n">parameters</span> <span class="n">whose</span> <span class="n">units</span> <span class="n">have</span> <span class="ow">not</span> <span class="n">been</span> <span class="n">declared</span><span class="p">,</span>
<span class="n">it</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">possible</span> <span class="n">to</span> <span class="n">verify</span> <span class="n">accurately</span> <span class="n">the</span> <span class="n">consistency</span> <span class="n">of</span> <span class="n">the</span> <span class="n">units</span> <span class="ow">in</span> <span class="n">the</span>
<span class="n">expression</span><span class="o">.</span>
</pre></div>
</div>
<p>These 10 warnings are all related to consistency of units of measurement.
Line numbers in the report refer to related SBML document ‘./results/tmp.xml’.</p>
<p>While warnings are not critical and the SBML model could still be created,
here we try correcting the issues in the spreadsheet <code class="docutils literal notranslate"><span class="pre">BIO10_upd.xlsx</span></code> and
create a SBML model which passes the validation step, i.e. having correct
units of measurement.</p>
</div>
<div class="section" id="model-update">
<h2>4. Model Update<a class="headerlink" href="#model-update" title="Permalink to this headline">¶</a></h2>
<p>Continuing from above we’ll correct the warning messages in the spreadsheet
document <code class="docutils literal notranslate"><span class="pre">BIO10_upd.xlsx</span></code>. Also note that the SBML version is still at
Level 2 Version 4. Updates required for higher SBML versions would be more.</p>
<p>From the scientific paper <a class="reference internal" href="references.html#mapk" id="id2"><span>[MAPK]</span></a> we know that Michaelis constants are in the
range of nanomolar (nM).</p>
<p>Let us try to introduce units into the model and also some other smaller
modifications. This is actually an interactive step for the modeler. He will
update the spreadsheet, import the spreadsheet with SBML and validate the model.
In case of Warnings or Errors, further correction is required.</p>
<p>Finally following updates to the model remove any of the warning messages:</p>
<p>Additional unit definitions <code class="docutils literal notranslate"><span class="pre">per_s</span></code>, <code class="docutils literal notranslate"><span class="pre">nM</span></code>, <code class="docutils literal notranslate"><span class="pre">nM_per_s</span></code> in sheet <code class="docutils literal notranslate"><span class="pre">unitDefs</span></code>
(highlighted in green). <code class="docutils literal notranslate"><span class="pre">metaid</span></code> values were not specified as not required.</p>
<img alt="_images/upd_unitDefs_L2V4.png" src="_images/upd_unitDefs_L2V4.png" />
<p>Updates to model reactions. We had to implement several configurations
(updates in green).</p>
<ul class="simple">
<li><p>Add unit definitions (which we defined in <code class="docutils literal notranslate"><span class="pre">unitsDef</span></code> sheet)
to all parameters in <code class="docutils literal notranslate"><span class="pre">localParams</span></code>. Unitless parameters,
e.g. <code class="docutils literal notranslate"><span class="pre">n</span></code> get <code class="docutils literal notranslate"><span class="pre">dimensionless</span></code> assigned.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kineticLaw</span></code> for reaction <code class="docutils literal notranslate"><span class="pre">J0</span></code> had a unitless <code class="docutils literal notranslate"><span class="pre">1</span></code> in the formula.
We introduced a local parameter <code class="docutils literal notranslate"><span class="pre">one</span></code>, which has the unit <code class="docutils literal notranslate"><span class="pre">dimensionless</span></code>
assigned. Note: SBML L3V2 supports <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">dimensionless</span></code> in the formula.</p></li>
<li><p>We also modified the cryptic <code class="docutils literal notranslate"><span class="pre">metaids</span></code>. This is not to correct any of the
warnings. It rather demonstrates how we can change attributes to our liking.</p></li>
</ul>
<img alt="_images/upd_reactions_L2V4.png" src="_images/upd_reactions_L2V4.png" />
<p>In the sheet <code class="docutils literal notranslate"><span class="pre">modelAttrs</span></code> we could add the <strong>current time</strong> to the
modification history. We do this by adding <code class="docutils literal notranslate"><span class="pre">;</span> <span class="pre">localtime</span></code> to the end of the
<code class="docutils literal notranslate"><span class="pre">modified-history</span></code> value.</p>
<img alt="_images/upd_modelAttrs_L2V4.png" src="_images/upd_modelAttrs_L2V4.png" />
<p>As there are no longer warnings, we can write out the model to SBML. Let’s give
it the name <code class="docutils literal notranslate"><span class="pre">BIO10_L2V4_with_units.xml</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">upd_model</span> <span class="o">=</span> <span class="n">sbmlxdf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;BIO10_upd.xlsx&#39;</span><span class="p">)</span>
<span class="n">upd_model</span><span class="o">.</span><span class="n">validate_sbml</span><span class="p">(</span><span class="s1">&#39;tmp.xml&#39;</span><span class="p">)</span>
<span class="p">{}</span>
<span class="n">upd_model</span> <span class="o">=</span> <span class="n">sbmlxdf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;BIO10_L2V4_with_units.xml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="sbml-model-in-latest-sbml-version">
<h2>5. SBML model in latest SBML version<a class="headerlink" href="#sbml-model-in-latest-sbml-version" title="Permalink to this headline">¶</a></h2>
<p>Continuing from above it is a small step to convert our model to the
latest version of SBML, currently Level 3 version 2.</p>
<p>We just slightly update our spreadsheet <code class="docutils literal notranslate"><span class="pre">BIO10_upd.xlsx</span></code>, which is still in
Level 2 version 4.</p>
<p>First we have to change <code class="docutils literal notranslate"><span class="pre">level</span></code> and <code class="docutils literal notranslate"><span class="pre">version</span></code> in sheet <code class="docutils literal notranslate"><span class="pre">sbml</span></code>.</p>
<img alt="_images/upd_sbml_L3V2.png" src="_images/upd_sbml_L3V2.png" />
<p>Validation check after this changes will show 30 warnings. Try it.</p>
<p>To get rid of these warnings, we have to add following attributes to sheet
<code class="docutils literal notranslate"><span class="pre">modelAttrs</span></code>:</p>
<ul class="simple">
<li><p><strong>substanceUnits</strong></p></li>
<li><p><strong>volumeUnits</strong></p></li>
<li><p><strong>timeUnits</strong></p></li>
<li><p><strong>extentUnits</strong></p></li>
</ul>
<img alt="_images/upd_modelAttrs_L3V2.png" src="_images/upd_modelAttrs_L3V2.png" />
<p>In sheet <code class="docutils literal notranslate"><span class="pre">reactions</span></code> we should add <code class="docutils literal notranslate"><span class="pre">stoic</span></code> and <code class="docutils literal notranslate"><span class="pre">const</span></code> attributes
to <code class="docutils literal notranslate"><span class="pre">reactants</span></code> and <code class="docutils literal notranslate"><span class="pre">products</span></code>. <code class="docutils literal notranslate"><span class="pre">constant</span></code> is a mandatory attribute in
SBML L3V2.
With SBML L3V2 we also could change back the kinetics of reaction <code class="docutils literal notranslate"><span class="pre">J0</span></code>, i.e.
inserting <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">dimensionless</span></code> into the <code class="docutils literal notranslate"><span class="pre">kineticLaw</span></code>.</p>
<img alt="_images/upd_reactions_L3V2.png" src="_images/upd_reactions_L3V2.png" />
<p>Now we can generate from out spreadsheet a SBML L3V2 compliant model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">upd_model</span> <span class="o">=</span> <span class="n">sbmlxdf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;BIO10_upd.xlsx&#39;</span><span class="p">)</span>
<span class="n">upd_model</span><span class="o">.</span><span class="n">validate_sbml</span><span class="p">(</span><span class="s1">&#39;tmp.xml&#39;</span><span class="p">)</span>
<span class="p">{}</span>
<span class="n">upd_model</span> <span class="o">=</span> <span class="n">sbmlxdf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;BIO10_L3V2_with_units.xml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="python-access-to-sbml-model-data">
<h2>6. Python access to SBML model data<a class="headerlink" href="#python-access-to-sbml-model-data" title="Permalink to this headline">¶</a></h2>
<p>Continuing from above we have generated from the SBML Biomodel
<code class="docutils literal notranslate"><span class="pre">BIOMD0000000010_url.xml</span></code> an updated SBML model in Level 3 Version 2 with
units of measurement added, <code class="docutils literal notranslate"><span class="pre">BIO10_L3V2_with_units.xml</span></code>.</p>
<p>Python programmers might require access to SBML data. Going through the pains
of interacting directly with <strong>libsbml</strong> can be avoided. sbmlxdf provides
access to SBML model data on the level of pandas dataframes.
You can extract SBML components and attributes, e.g. for use
in your optimization code. <code class="docutils literal notranslate"><span class="pre">kineticLaws</span></code> and other mathematical
constructs can be converted to Python functions, e.g. for ODE analysis.</p>
<p>To access SBML data, import a model and convert it to a set of dataframes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">sbmlxdf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;BIO10_L3V2_with_units.xml&#39;</span><span class="p">)</span>
<span class="n">model_df</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_df</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

<span class="n">dict_keys</span><span class="p">([</span><span class="s1">&#39;sbml&#39;</span><span class="p">,</span> <span class="s1">&#39;modelAttrs&#39;</span><span class="p">,</span> <span class="s1">&#39;unitDefs&#39;</span><span class="p">,</span> <span class="s1">&#39;compartments&#39;</span><span class="p">,</span> <span class="s1">&#39;species&#39;</span><span class="p">,</span>
<span class="s1">&#39;reactions&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Function <code class="docutils literal notranslate"><span class="pre">sbmlxdf.extract_records()</span></code> can be used to extract individual
records, e.g. there can be several reactants in a reaction.
Function <code class="docutils literal notranslate"><span class="pre">sbmlxdf.extract_params()</span></code> can be used to extract a dictionary of
key-value pairs from a record, e.g. to get all attributes of a reactant.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_r</span> <span class="o">=</span> <span class="n">model_df</span><span class="p">[</span><span class="s1">&#39;reactions&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_r</span><span class="p">),</span> <span class="s1">&#39;reactions found, first reaction:&#39;</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_r</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">reactants and products for some reactions:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">df_r</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;reaction:&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">sbmlxdf</span><span class="o">.</span><span class="n">extract_records</span><span class="p">(</span><span class="n">reaction</span><span class="p">[</span><span class="s1">&#39;reactants&#39;</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  reactant: &#39;</span><span class="p">,</span> <span class="n">sbmlxdf</span><span class="o">.</span><span class="n">extract_params</span><span class="p">(</span><span class="n">record</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">sbmlxdf</span><span class="o">.</span><span class="n">extract_records</span><span class="p">(</span><span class="n">reaction</span><span class="p">[</span><span class="s1">&#39;products&#39;</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  product:  &#39;</span><span class="p">,</span> <span class="n">sbmlxdf</span><span class="o">.</span><span class="n">extract_params</span><span class="p">(</span><span class="n">record</span><span class="p">))</span>

<span class="mi">10</span> <span class="n">reactions</span> <span class="n">found</span><span class="p">,</span> <span class="n">first</span> <span class="n">reaction</span><span class="p">:</span>
<span class="n">name</span>                                                 <span class="n">MAPKKK</span> <span class="n">activation</span>
<span class="n">metaid</span>                                                              <span class="n">J0</span>
<span class="n">miriam</span><span class="o">-</span><span class="n">annotation</span>    <span class="n">bqbiol</span><span class="p">:</span><span class="n">isHomologTo</span><span class="p">,</span> <span class="n">reactome</span><span class="o">/</span><span class="n">REACT_525</span><span class="p">;</span> <span class="n">bqbiol</span><span class="o">...</span>
<span class="n">reversible</span>                                                       <span class="kc">False</span>
<span class="n">reactants</span>                          <span class="n">species</span><span class="o">=</span><span class="n">MKKK</span><span class="p">,</span> <span class="n">stoic</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="kc">True</span>
<span class="n">products</span>                         <span class="n">species</span><span class="o">=</span><span class="n">MKKK_P</span><span class="p">,</span> <span class="n">stoic</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="kc">True</span>
<span class="n">modifiers</span>                                              <span class="n">species</span><span class="o">=</span><span class="n">MAPK_PP</span>
<span class="n">kineticLaw</span>           <span class="n">uVol</span> <span class="o">*</span> <span class="n">V1</span> <span class="o">*</span> <span class="n">MKKK</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="n">dimensionless</span> <span class="o">+</span> <span class="p">(</span><span class="n">MAPK_P</span><span class="o">...</span>
<span class="n">localParams</span>          <span class="nb">id</span><span class="o">=</span><span class="n">V1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">nM_per_s</span><span class="p">;</span> <span class="nb">id</span><span class="o">=</span><span class="n">Ki</span><span class="p">,</span> <span class="n">value</span><span class="o">...</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">J0</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="n">reactants</span> <span class="ow">and</span> <span class="n">products</span> <span class="k">for</span> <span class="n">some</span> <span class="n">reactions</span><span class="p">:</span>
<span class="n">reaction</span><span class="p">:</span> <span class="n">J0</span>
  <span class="n">reactant</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;species&#39;</span><span class="p">:</span> <span class="s1">&#39;MKKK&#39;</span><span class="p">,</span> <span class="s1">&#39;stoic&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;const&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">}</span>
  <span class="n">product</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;species&#39;</span><span class="p">:</span> <span class="s1">&#39;MKKK_P&#39;</span><span class="p">,</span> <span class="s1">&#39;stoic&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;const&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">}</span>
<span class="n">reaction</span><span class="p">:</span> <span class="n">J1</span>
  <span class="n">reactant</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;species&#39;</span><span class="p">:</span> <span class="s1">&#39;MKKK_P&#39;</span><span class="p">,</span> <span class="s1">&#39;stoic&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;const&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">}</span>
  <span class="n">product</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;species&#39;</span><span class="p">:</span> <span class="s1">&#39;MKKK&#39;</span><span class="p">,</span> <span class="s1">&#39;stoic&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;const&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">}</span>
<span class="n">reaction</span><span class="p">:</span> <span class="n">J2</span>
  <span class="n">reactant</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;species&#39;</span><span class="p">:</span> <span class="s1">&#39;MKK&#39;</span><span class="p">,</span> <span class="s1">&#39;stoic&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;const&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">}</span>
  <span class="n">product</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;species&#39;</span><span class="p">:</span> <span class="s1">&#39;MKK_P&#39;</span><span class="p">,</span> <span class="s1">&#39;stoic&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;const&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>It is also possible to retrieve the stoichiometric matrix using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">get_s_matrix</span><span class="p">())</span>

          <span class="n">J0</span>   <span class="n">J1</span>   <span class="n">J2</span>   <span class="n">J3</span>   <span class="n">J4</span>   <span class="n">J5</span>   <span class="n">J6</span>   <span class="n">J7</span>   <span class="n">J8</span>   <span class="n">J9</span>
<span class="n">MKKK</span>    <span class="o">-</span><span class="mf">1.0</span>  <span class="mf">1.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>
<span class="n">MKKK_P</span>   <span class="mf">1.0</span> <span class="o">-</span><span class="mf">1.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>
<span class="n">MKK</span>      <span class="mf">0.0</span>  <span class="mf">0.0</span> <span class="o">-</span><span class="mf">1.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">1.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>
<span class="n">MKK_P</span>    <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">1.0</span> <span class="o">-</span><span class="mf">1.0</span>  <span class="mf">1.0</span> <span class="o">-</span><span class="mf">1.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>
<span class="n">MKK_PP</span>   <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">1.0</span> <span class="o">-</span><span class="mf">1.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>
<span class="n">MAPK</span>     <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span> <span class="o">-</span><span class="mf">1.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">1.0</span>
<span class="n">MAPK_P</span>   <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">1.0</span> <span class="o">-</span><span class="mf">1.0</span>  <span class="mf">1.0</span> <span class="o">-</span><span class="mf">1.0</span>
<span class="n">MAPK_PP</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">1.0</span> <span class="o">-</span><span class="mf">1.0</span>  <span class="mf">0.0</span>
</pre></div>
</div>
</div>
<div class="section" id="run-time-course-analysis">
<h2>7. Run time course analysis<a class="headerlink" href="#run-time-course-analysis" title="Permalink to this headline">¶</a></h2>
<p>Once we have a SBML model, we might want to run a time course
analysis to see the change of concentrations over time.
Let us use the SBML model ‘BIO10_L3V2_with_units.xml’.</p>
<p>I’ll present two methods for time course analysis.
Users without Python programming experience can use the graphical tool
<a class="reference external" href="copasi.org">COPASI</a>. Alternatively, you can use the Python package
<a class="reference external" href="http://tellurium.analogmachine.org">tellurium</a>, but this requires
some coding.</p>
<div class="section" id="time-course-analysis-in-copasi">
<h3>7.1 Time course analysis in COPASI<a class="headerlink" href="#time-course-analysis-in-copasi" title="Permalink to this headline">¶</a></h3>
<p>Assuming you already installed <strong>COPASI</strong> on your system. The example below
is based on COPASI 4.33 (Build 246).</p>
<p>These are the steps for generating a time course plot:</p>
<ul>
<li><p>open <strong>COPASI</strong> application</p></li>
<li><p>import the SBML model via menu <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">-&gt;</span> <span class="pre">Import</span> <span class="pre">SBML</span> <span class="pre">...</span></code>,
select SBML file <code class="docutils literal notranslate"><span class="pre">BIO10_L3V2_with_units.xml</span></code>.
In my system a warning messages comes up, informing me that <em>length unit</em> and
<em>area unit</em> are not defined. Don’t worry, these units are not used
in our model.</p>
<p>COPASI converts the SBML model into its internal format.</p>
<img alt="_images/copasi_model.png" src="_images/copasi_model.png" />
</li>
<li><p>create a plot:
<code class="docutils literal notranslate"><span class="pre">COPASI</span> <span class="pre">-&gt;</span> <span class="pre">Output</span> <span class="pre">Specifications</span> <span class="pre">-&gt;</span> <span class="pre">Plots[0]</span></code>.
Add a <code class="docutils literal notranslate"><span class="pre">New</span></code> plot and add a <code class="docutils literal notranslate"><span class="pre">New</span> <span class="pre">Curve</span></code>,
select for <code class="docutils literal notranslate"><span class="pre">X-Axis</span></code> <code class="docutils literal notranslate"><span class="pre">Time</span> <span class="pre">-&gt;</span> <span class="pre">Model</span> <span class="pre">Time</span></code>,
select for <code class="docutils literal notranslate"><span class="pre">Y-Axis</span></code> <code class="docutils literal notranslate"><span class="pre">Species</span> <span class="pre">-&gt;</span> <span class="pre">Transient</span> <span class="pre">Concentrations</span></code> and confirm.</p>
<img alt="_images/copasi_plot_definition.png" src="_images/copasi_plot_definition.png" />
</li>
<li><p>preform time course analysis:
<code class="docutils literal notranslate"><span class="pre">COPASI</span> <span class="pre">-&gt;</span> <span class="pre">Tasks</span> <span class="pre">-&gt;</span> <span class="pre">Time</span> <span class="pre">Course</span></code>
Set <code class="docutils literal notranslate"><span class="pre">Duration</span> <span class="pre">[s]</span></code> to <code class="docutils literal notranslate"><span class="pre">1800</span></code> and <code class="docutils literal notranslate"><span class="pre">Intervals</span></code> to <code class="docutils literal notranslate"><span class="pre">1000</span></code>.
Press <code class="docutils literal notranslate"><span class="pre">Run</span></code></p>
<img alt="_images/copasi_timecourse.png" src="_images/copasi_timecourse.png" />
</li>
<li><p>a plot showing the concentrations over time should appear. It not, the plot
window might be hidden by other windows.</p>
<img alt="_images/copasi_plot_result.png" src="_images/copasi_plot_result.png" />
</li>
</ul>
</div>
<div class="section" id="time-course-in-tellurium">
<h3>7.2 Time course in tellurium<a class="headerlink" href="#time-course-in-tellurium" title="Permalink to this headline">¶</a></h3>
<p>Assuming you already pip installed the tellurium package.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tellurium</span> <span class="k">as</span> <span class="nn">te</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">te</span><span class="o">.</span><span class="n">loadSBMLModel</span><span class="p">(</span><span class="s1">&#39;BIO10_L3V2_with_units.xml&#39;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/tellurium_plot_result.png"><img alt="_images/tellurium_plot_result.png" src="_images/tellurium_plot_result.png" style="width: 374.0px; height: 248.0px;" /></a>
</div>
</div>
<div class="section" id="adding-application-specific-annotations">
<h2>8. Adding application specific annotations<a class="headerlink" href="#adding-application-specific-annotations" title="Permalink to this headline">¶</a></h2>
<p>As an implementer of optimization methods you might require application
specific attributes on SBML components. This can be done using the annotation
mechanism provided by SBML.</p>
<p>Continuing from the model above, we might be interested in the molecular
weight of the species involved in the reactions and possibly the length of the
proteins. We might required these attributes to configure additional
constraints during optimization. We could add this information as SBML
parameters to the <code class="docutils literal notranslate"><span class="pre">parameters</span></code> sheet (not discussed yet).
However, we would have difficulties linking <code class="docutils literal notranslate"><span class="pre">species</span></code>
objects with corresponding <code class="docutils literal notranslate"><span class="pre">parameters</span></code> object.</p>
<p>Using the annotation mechanism we can directly add our required attributes
on the level of <code class="docutils literal notranslate"><span class="pre">species</span></code>. Let us extend our spreadsheet <code class="docutils literal notranslate"><span class="pre">BIO10_upd.xlsx</span></code>.</p>
<p>To benefit from spreadsheet features, we
add a sheet <code class="docutils literal notranslate"><span class="pre">helpers</span></code> and copy relevant information from the
<code class="docutils literal notranslate"><span class="pre">species</span></code> sheet. The <code class="docutils literal notranslate"><span class="pre">miriam-annotation</span></code> values provide references
to <code class="docutils literal notranslate"><span class="pre">UniProt</span></code> database. We manually lookup
<a class="reference external" href="https://www.uniprot.org">UniProt</a> and search for the <strong>unitprot ids</strong> used
in our model. In the <strong>Sequence</strong> section we find protein length and
molecular weight, which we add to our table.
Just as an example, we also add weights of inorganic phosphates.
Using Excel <code class="docutils literal notranslate"><span class="pre">concat()</span></code> function we create <code class="docutils literal notranslate"><span class="pre">xml-annotations</span></code>
using fixed namespace, token and prefix and
variable values from our table. Note: Here I define an arbitrary namespace.</p>
<img alt="_images/upd_helper_xml.png" src="_images/upd_helper_xml.png" />
<p>Subsequently we <strong>copy</strong> the <code class="docutils literal notranslate"><span class="pre">xml-annotation</span></code> column and
<strong>Paste Special - Values</strong> it into our <code class="docutils literal notranslate"><span class="pre">species</span></code> sheet.
I also updated the <code class="docutils literal notranslate"><span class="pre">metaid</span></code> values.</p>
<img alt="_images/upd_species_xml.png" src="_images/upd_species_xml.png" />
<p>We import the spreadsheet, validate it and create our new SBML
<code class="docutils literal notranslate"><span class="pre">BIO10_L3V2_with_XML_annot.xml</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">upd_model</span> <span class="o">=</span> <span class="n">sbmlxdf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;BIO10_upd.xlsx&#39;</span><span class="p">)</span>
<span class="n">upd_model</span><span class="o">.</span><span class="n">validate_sbml</span><span class="p">(</span><span class="s1">&#39;tmp.xml&#39;</span><span class="p">)</span>
<span class="p">{}</span>
<span class="n">upd_model</span><span class="o">.</span><span class="n">export_sbml</span><span class="p">(</span><span class="s1">&#39;BIO10_L3V2_with_XML_annot.xml&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>As a Python programmer you now have access to the additional attributes,
which is demonstrated in below code block:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">sbmlxdf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;BIO10_L3V2_with_XML_annot.xml&#39;</span><span class="p">)</span>
<span class="n">model_df</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
<span class="n">df_s</span> <span class="o">=</span> <span class="n">model_df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">species</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df_s</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">attrs</span> <span class="o">=</span> <span class="n">sbmlxdf</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">extract_xml_attrs</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;xml-annotation&#39;</span><span class="p">],</span> <span class="n">token</span><span class="o">=</span><span class="s1">&#39;molecule&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>

<span class="n">MKKK</span> <span class="p">{</span><span class="s1">&#39;weight_Da&#39;</span><span class="p">:</span> <span class="s1">&#39;71960&#39;</span><span class="p">,</span> <span class="s1">&#39;prot_len&#39;</span><span class="p">:</span> <span class="s1">&#39;638&#39;</span><span class="p">}</span>
<span class="n">MKKK_P</span> <span class="p">{</span><span class="s1">&#39;weight_Da&#39;</span><span class="p">:</span> <span class="s1">&#39;72039&#39;</span><span class="p">,</span> <span class="s1">&#39;prot_len&#39;</span><span class="p">:</span> <span class="s1">&#39;638&#39;</span><span class="p">}</span>
<span class="n">MKK</span> <span class="p">{</span><span class="s1">&#39;weight_Da&#39;</span><span class="p">:</span> <span class="s1">&#39;43900&#39;</span><span class="p">,</span> <span class="s1">&#39;prot_len&#39;</span><span class="p">:</span> <span class="s1">&#39;395&#39;</span><span class="p">}</span>
<span class="n">MKK_P</span> <span class="p">{</span><span class="s1">&#39;weight_Da&#39;</span><span class="p">:</span> <span class="s1">&#39;43821&#39;</span><span class="p">,</span> <span class="s1">&#39;prot_len&#39;</span><span class="p">:</span> <span class="s1">&#39;395&#39;</span><span class="p">}</span>
<span class="n">MKK_PP</span> <span class="p">{</span><span class="s1">&#39;weight_Da&#39;</span><span class="p">:</span> <span class="s1">&#39;43900&#39;</span><span class="p">,</span> <span class="s1">&#39;prot_len&#39;</span><span class="p">:</span> <span class="s1">&#39;395&#39;</span><span class="p">}</span>
<span class="n">MAPK</span> <span class="p">{</span><span class="s1">&#39;weight_Da&#39;</span><span class="p">:</span> <span class="s1">&#39;41257&#39;</span><span class="p">,</span> <span class="s1">&#39;prot_len&#39;</span><span class="p">:</span> <span class="s1">&#39;361&#39;</span><span class="p">}</span>
<span class="n">MAPK_P</span> <span class="p">{</span><span class="s1">&#39;weight_Da&#39;</span><span class="p">:</span> <span class="s1">&#39;41336&#39;</span><span class="p">,</span> <span class="s1">&#39;prot_len&#39;</span><span class="p">:</span> <span class="s1">&#39;361&#39;</span><span class="p">}</span>
<span class="n">MAPK_PP</span> <span class="p">{</span><span class="s1">&#39;weight_Da&#39;</span><span class="p">:</span> <span class="s1">&#39;41415&#39;</span><span class="p">,</span> <span class="s1">&#39;prot_len&#39;</span><span class="p">:</span> <span class="s1">&#39;361&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="scripts.html" class="btn btn-neutral float-right" title="Command Line Scripts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="install.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Peter Schubert.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>